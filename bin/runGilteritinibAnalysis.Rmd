---
title: "Gilteritinib Analysis"
author: "Sara Gosline"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(amlresistancenetworks)
require(dplyr)
```

## Get Data

This package has formatted the Gilteritnib-treated AML cells into a tidied data frame so they can be easily processed. 

Conditions:
```{r Load Data}
gilt.data<-readRDS(system.file('gilteritinibData.Rds',package='amlresistancenetworks'))

#view as table
samps<-gilt.data%>%
  dplyr::select(c(ligand,CellLine,treatment))%>%distinct()

DT::datatable(samps)
```

## Compute fold changes for conditions of interest


Here is the meat of the challenge - compute significant LFCs for each condition.

```{r LFC heatmap, echo=FALSE}

library(pheatmap)

```
## Compute raw differences between ligand treatments

Now we can compute the differences between conditions using a basic difference approach (nothing fancy). We can then get the differences between treatments for each protein. 

```{r raw differences,echo=FALSE}

#reduce data
data<-gilt.data%>%
    subset(treatment%in%(c('None','Early Gilteritinib')))%>%
    select(CellLine,Gene,value,ligand)

#get mean value for each gene,cell line, ligand (is this appropriate?)
mean.vals<-data%>%
    group_by(CellLine,Gene,ligand)%>%
    summarize(meanVals=mean(value,na.rm=T))%>%
    tidyr::pivot_wider(names_from=ligand,values_from=meanVals)

mean.diffs<-mean.vals%>%
  mutate(FGF2_to_parent=FGF2-None)%>%
  mutate(FL_to_parent=FL-None)


### FGF2 vs FLT3 Ligand in MV411

MV411 cell line results

### FGF2 vs FLT3 Ligand in MOLM14 


## Now create networks from the LFC
Now that we've evaluated the differences 
